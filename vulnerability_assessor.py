# scripts/vulnerability_assessment.py

import requests

def fetch_cve_data(ip):
    """Fetch CVEs related to the given IP address."""
    url = f"https://cve.circl.lu/api/last"
    response = requests.get(url)
    if response.status_code == 200:
        cve_data = response.json()
        relevant_cves = [cve for cve in cve_data if ip in cve['affects']]
        return relevant_cves
    return []

def assess_vulnerabilities(devices):
    """Assess vulnerabilities of discovered devices."""
    vulnerabilities = {}
    for device in devices:
        ip = device['ip']
        cves = fetch_cve_data(ip)
        if cves:
            vulnerabilities[ip] = [cve['id'] for cve in cves]
        else:
            vulnerabilities[ip] = ["No known vulnerabilities"]
    return vulnerabilities
